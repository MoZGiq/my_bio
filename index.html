<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ü—Ä–æ—Ñ–∏–ª—å ‚Ä¢ Link in bio</title>
  <meta name="description" content="–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏" />
  <meta name="theme-color" content="#7c3aed" />

  <!-- OG -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="–ü—Ä–æ—Ñ–∏–ª—å" />
  <meta property="og:description" content="–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏" />
  <meta property="og:image" content="" />
  <meta property="og:url" content="" />

  <!-- –®—Ä–∏—Ñ—Ç -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet" />

  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><circle cx=%2250%22 cy=%2250%22 r=%2240%22 fill=%22%237c3aed%22/></svg>">

  <style>
    :root{
      --accent:#7c3aed;
      --grad-1:#0ea5ea;
      --grad-2:#7c3aed;

      --text:#e7e7ea;
      --muted:#b4b4bf;
      --card-bg:rgba(255,255,255,0.06);
      --card-br:rgba(255,255,255,0.14);
      --shadow:0 10px 35px rgba(10,10,20,0.4);

      /* UI */
      --icon-size:64px;
      --icon-radius:16px;
      --grid-min:82px;
      --avatar-radius:20px;
      --labels-visible:1;
    }

    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,sans-serif;
      color:var(--text);
      background:#0b0c16;
      display:grid;
      place-items:center;
      padding:32px 16px 48px;
      overflow-x:hidden;
    }

    /* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ñ–æ–Ω */
    .custom-bg{ position:fixed; inset:0; z-index:0; pointer-events:none; overflow:hidden; }
    .custom-bg::before{
      content:"";
      position:absolute; inset:0;
      background:center/cover no-repeat;
      filter:blur(var(--bg-blur,0px)) saturate(var(--bg-sat,1));
      opacity:var(--bg-opacity,1);
      transition:opacity .25s ease, filter .25s ease;
    }
    .custom-bg video{
      position:absolute; inset:0;
      width:100%; height:100%;
      object-fit:cover;
      filter:blur(var(--bg-blur,0px)) saturate(var(--bg-sat,1));
      opacity:var(--bg-opacity,1);
    }

    /* –ù–µ–æ–Ω–æ–≤–∞—è –¥—ã–º–∫–∞ */
    .bg{
      position:fixed; inset:0; z-index:1; pointer-events:none;
      background:
        radial-gradient(1000px 1000px at 50% -20%, var(--grad-1), transparent 60%),
        radial-gradient(800px 800px at 120% 0%, var(--grad-2), transparent 60%);
      filter:blur(60px) saturate(1.1);
      opacity:.35;
    }

    .card{
      position:relative; z-index:2;
      width:100%; max-width:560px;
      background:var(--card-bg);
      border:1px solid var(--card-br);
      border-radius:22px;
      box-shadow:var(--shadow);
      backdrop-filter:blur(12px);
      -webkit-backdrop-filter:blur(12px);
      padding:28px 24px;
      text-align:center;
    }

    .avatar-wrap{ position:relative; width:112px; height:112px; margin:6px auto 14px; }
    .avatar{
      width:100%; height:100%;
      border-radius:var(--avatar-radius);
      object-fit:cover;
      border:2px solid rgba(255,255,255,.25);
      box-shadow:0 10px 30px rgba(0,0,0,.35);
      display:block; cursor:pointer;
    }
    .avatar-edit{
      position:absolute; right:-6px; bottom:-6px;
      width:28px; height:28px; border-radius:9px;
      display:grid; place-items:center; font-size:14px; color:#fff;
      background:color-mix(in oklab, var(--accent) 50%, #0000);
      border:1px solid color-mix(in oklab, var(--accent) 70%, #ffffff1a);
      box-shadow:0 8px 20px color-mix(in oklab, var(--accent) 30%, #0000);
      pointer-events:none;
    }

    .name{ font-size:28px; font-weight:800; letter-spacing:.2px; margin:0; }
    .username{ margin-top:6px; color:var(--muted); font-weight:600; }
    .bio{ margin:14px auto 10px; color:#d9d9e4; line-height:1.55; max-width:44ch; }

    /* –≠–º–æ–¥–∑–∏-—Å–µ—Ç–∫–∞ */
    .emoji-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(var(--grid-min),1fr));
      gap:14px;
      margin:18px 0 6px;
      justify-items:center;
    }
    .emoji-btn{
      --link-color:var(--accent);
      display:grid; justify-items:center; gap:8px;
      text-decoration:none; color:#f1f1f6;
    }
    .emoji-ico{
      width:var(--icon-size); height:var(--icon-size);
      border-radius:var(--icon-radius);
      display:grid; place-items:center; font-size:calc(var(--icon-size) * .44);
      background:color-mix(in oklab, var(--link-color) 22%, transparent);
      border:1px solid color-mix(in oklab, var(--link-color) 60%, #ffffff1a);
      box-shadow:0 10px 22px color-mix(in oklab, var(--link-color) 30%, transparent);
      transition:transform .12s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .emoji-btn:hover .emoji-ico{ transform:translateY(-2px) scale(1.03) }
    .emoji-btn:active .emoji-ico{ transform:translateY(0) scale(1.0) }
    .emoji-label{
      font-size:12px; color:var(--muted); font-weight:700; letter-spacing:.2px; line-height:1;
      max-width:9ch; text-overflow:ellipsis; overflow:hidden; white-space:nowrap;
      display:inline-block; opacity:var(--labels-visible);
    }

    .footer{
      position:fixed; z-index:2; left:0; right:0; bottom:12px;
      text-align:center; color:#a8a8b5; font-size:12px; pointer-events:none;
    }
    .footer .dot{ margin:0 6px; opacity:.5 }
    @media (max-width: 420px){
      .card{ padding:22px 16px; }
      .name{ font-size:24px; }
      .avatar-wrap{ width:100px; height:100px; }
      .emoji-ico{ font-size:calc(var(--icon-size) * .45); }
    }
  </style>
</head>
<body>
<!-- –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ñ–æ–Ω -->
<div class="custom-bg" id="customBg" aria-hidden="true"></div>
<!-- –ù–µ–æ–Ω–æ–≤–∞—è –¥—ã–º–∫–∞ -->
<div class="bg" aria-hidden="true"></div>

<main class="card" id="card">
  <div class="avatar-wrap">
    <img id="avatar" class="avatar" src="" alt="–ê–≤–∞—Ç–∞—Ä" title="–ù–∞–∂–º–∏, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å" />
    <div class="avatar-edit" aria-hidden="true">‚úèÔ∏è</div>
    <input id="avatarInput" type="file" accept="image/*" hidden />
  </div>

  <h1 id="name" class="name"></h1>
  <div id="username" class="username"></div>
  <p id="bio" class="bio"></p>

  <!-- –°–µ—Ç–∫–∞ —ç–º–æ–¥–∑–∏‚Äë–∫–Ω–æ–ø–æ–∫ -->
  <div class="emoji-grid" id="links"></div>
</main>

<footer class="footer">
  <span id="location"></span>
  <span class="dot" aria-hidden="true">‚Ä¢</span>
  <span>2025 –≥–æ–¥</span>
</footer>

<script>
  // ========= –ü–†–û–§–ò–õ–¨ =========
  window.PROFILE = {
    name: "MoZGi",
    username: "maxvanila",
    bio: "Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ ‚Ä¢ React / Next.js ‚Ä¢ coffee-driven ‚òïÔ∏è",
    location: "Moscow, RU",
    avatar: "https://i.pravatar.cc/240?img=68",

    theme: {
      preset: "pinkviolet", // acid | pinkviolet | neon | ""
      accent: null,
      gradient: null
    },

    background: {
      image: "https://images.unsplash.com/photo-1552083375-1447ce886485?q=80&w=1920&auto=format&fit=crop",
      video: null,
      blur: 8,
      opacity: 0.9,
      saturate: 1.1,
      fit: "cover"
    },

    behavior: {
      persistAvatar: true
    },

    ui: {
      iconSize: 64,
      iconRadius: 16,
      avatarRadius: 20,
      gridMin: 82,
      showLabels: true
    },

    links: [
      { label: "Telegram", url: "https://t.me/maxvanila", icon: "‚úàÔ∏è", color: "#229ED9" },
      { label: "VK",       url: "https://vk.com/maxvanila", icon: "üü¶", color: "#0077FF" },
      { label: "GitHub",   url: "https://github.com/maxvanila", icon: "üíª", color: "#333333" },
      { label: "YouTube",  url: "https://youtube.com/@maxvanila", icon: "‚ñ∂Ô∏è", color: "#FF0033" },
    ]
  };
</script>

<script>
  (function(){
    const THEMES = {
      acid:       { accent:"#b4ff1f", gradient:["#00ffd1","#b4ff1f"] },
      pinkviolet: { accent:"#ff4db8", gradient:["#ff4db8","#7c3aed"] },
      neon:       { accent:"#00e5ff", gradient:["#00ffa3","#00e5ff"] }
    };

    const DEFAULT = deepClone(window.PROFILE);
    let profile = deepClone(DEFAULT);

    const $ = s => document.querySelector(s);

    // DOM
    const avatarEl = $("#avatar");
    const avatarInput = $("#avatarInput");
    const customBg = $("#customBg");
    const nameEl = $("#name");
    const usernameEl = $("#username");
    const bioEl = $("#bio");
    const linksEl = $("#links");
    const footerLocation = $("#location");

    // ========== INIT ==========
    loadFromStorage();
    loadFromURL(); // –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ p ‚Äî –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å, —Å–æ—Ö—Ä–∞–Ω–∏—Ç –∏ –ø–æ—á–∏—Å—Ç–∏—Ç URL
    applyTheme();
    applyBackground();
    applyUI();
    renderProfile();
    bindAvatarEdit();

    // ========== THEME ==========
    function applyTheme(){
      const t = profile.theme || {};
      const presetObj = t.preset && THEMES[t.preset] ? THEMES[t.preset] : null;
      const accent = t.accent || presetObj?.accent || "#7c3aed";
      const grad = t.gradient || presetObj?.gradient || ["#0ea5ea","#7c3aed"];

      const root = document.documentElement;
      root.style.setProperty("--accent", accent);
      root.style.setProperty("--grad-1", grad[0]);
      root.style.setProperty("--grad-2", grad[1]);

      const themeMeta = document.querySelector('meta[name="theme-color"]');
      if (themeMeta) themeMeta.setAttribute("content", accent);
    }

    // ========== BACKGROUND ==========
    function applyBackground(){
      const bg = profile.background || {};
      customBg.innerHTML = "";
      customBg.style.setProperty("--bg-blur", (bg.blur||0) + "px");
      customBg.style.setProperty("--bg-opacity", (bg.opacity ?? 1));
      customBg.style.setProperty("--bg-sat", (bg.saturate || 1));

      ensureStyleBlock("bg-inline-style", `
        #customBg::before{
          background-image:${bg.image ? `url("${bg.image}")` : "none"};
          background-size:${bg.fit || "cover"};
          background-position:center;
        }
      `);

      if (bg.video){
        const v = document.createElement("video");
        v.src = bg.video; v.autoplay = true; v.loop = true; v.muted = true; v.playsInline = true;
        v.style.objectFit = bg.fit || "cover";
        customBg.appendChild(v);
      }
    }

    // ========== UI VARS ==========
    function applyUI(){
      const ui = profile.ui || {};
      const root = document.documentElement;
      root.style.setProperty("--icon-size", (ui.iconSize||64) + "px");
      root.style.setProperty("--icon-radius", (ui.iconRadius||16) + "px");
      root.style.setProperty("--avatar-radius", (ui.avatarRadius||20) + "px");
      root.style.setProperty("--grid-min", (ui.gridMin||82) + "px");
      root.style.setProperty("--labels-visible", ui.showLabels ? "1" : "0");
    }

    // ========== META ==========
    function setMeta(name, content){ const el=document.querySelector(`meta[name="${name}"]`); if(el) el.setAttribute("content", content); }
    function setOG(property, content){ const el=document.querySelector(`meta[property="${property}"]`); if(el) el.setAttribute("content", content); }

    // ========== RENDER ==========
    function renderProfile(){
      const savedAvatar = profile.behavior?.persistAvatar ? localStorage.getItem("profile_avatar") : null;
      avatarEl.src = savedAvatar || profile.avatar || "";
      avatarEl.alt = profile.name ? `–ê–≤–∞—Ç–∞—Ä ${profile.name}` : "–ê–≤–∞—Ç–∞—Ä";

      nameEl.textContent = profile.name || "";
      usernameEl.textContent = profile.username ? `@${profile.username}` : "";
      bioEl.textContent = profile.bio || "";
      footerLocation.textContent = profile.location || "";

      const title = profile.name ? `${profile.name} ‚Ä¢ ${profile.username ? '@' + profile.username : 'profile'}` : "–ü—Ä–æ—Ñ–∏–ª—å";
      document.title = title;
      setMeta("description", profile.bio || "–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏");
      setOG("og:title", title);
      setOG("og:description", profile.bio || "");
      setOG("og:image", avatarEl.src || "");
      setOG("og:url", window.location.href);

      linksEl.innerHTML = "";
      (profile.links || []).forEach(link=>{
        const a = document.createElement("a");
        a.className = "emoji-btn";
        a.href = link.url; a.target = "_blank"; a.rel="noopener noreferrer";
        a.ariaLabel = link.label || domainFrom(link.url) || "–°—Å—ã–ª–∫–∞";
        a.title = `${link.label || "–°—Å—ã–ª–∫–∞"} ‚Ä¢ ${domainFrom(link.url)}`;
        if (link.color) a.style.setProperty("--link-color", link.color);

        const ico = document.createElement("div");
        ico.className = "emoji-ico";
        ico.textContent = link.icon || "üîó";

        const label = document.createElement("div");
        label.className = "emoji-label";
        label.textContent = link.label || domainFrom(link.url) || "Link";

        a.appendChild(ico);
        a.appendChild(label);
        linksEl.appendChild(a);
      });
    }

    // ========== AVATAR EDIT ==========
    function bindAvatarEdit(){
      const input = avatarInput;
      function handleFile(file){
        if (!file || !file.type?.startsWith("image")) return;
        const reader = new FileReader();
        reader.onload = ()=> {
          const dataUrl = reader.result;
          avatarEl.src = dataUrl;
          if (profile.behavior?.persistAvatar) {
            try { localStorage.setItem("profile_avatar", dataUrl); } catch {}
          }
        };
        reader.readAsDataURL(file);
      }
      avatarEl.addEventListener("click", ()=> input.click());
      input.addEventListener("change", e=>{ handleFile(e.target.files?.[0]); input.value = "" });
      avatarEl.addEventListener("dragover", e=>{ e.preventDefault(); });
      avatarEl.addEventListener("drop", e=>{ e.preventDefault(); handleFile(e.dataTransfer?.files?.[0]); });
    }

    // ========== STORAGE / SHARE ==========
    function save(){
      try { localStorage.setItem("profile_data", JSON.stringify(profile)); } catch {}
    }
    function loadFromStorage(){
      try {
        const raw = localStorage.getItem("profile_data");
        if (!raw) return false;
        profile = normalize(JSON.parse(raw));
        return true;
      } catch { return false; }
    }

    function b64ToUtf8(b64){
      return decodeURIComponent(Array.prototype.map.call(atob(b64), c => '%' + c.charCodeAt(0).toString(16).padStart(2,'0')).join(''));
    }
    function loadFromURL(){
      const url = new URL(window.location.href);
      const p = url.searchParams.get("p");
      if (!p) return false;
      try {
        const json = b64ToUtf8(p);
        const data = JSON.parse(json);
        profile = normalize(data);
        save(); // –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è

        // —É–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ p, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ hash –æ—Å—Ç–∞–≤–∏—Ç—å
        url.searchParams.delete("p");
        const clean = url.pathname + (url.searchParams.toString() ? "?" + url.searchParams.toString() : "") + url.hash;
        history.replaceState({}, "", clean);
        return true;
      } catch(e){
        console.warn("Bad config in URL", e);
        return false;
      }
    }

    // ========== HELPERS ==========
    function deepClone(x){ return JSON.parse(JSON.stringify(x)); }
    function normalize(data){
      const out = deepClone(DEFAULT);
      Object.assign(out, data);
      out.theme = Object.assign({}, DEFAULT.theme, data.theme||{});
      out.background = Object.assign({}, DEFAULT.background, data.background||{});
      out.behavior = Object.assign({}, DEFAULT.behavior, data.behavior||{});
      out.ui = Object.assign({}, DEFAULT.ui, data.ui||{});
      out.links = Array.isArray(data.links) ? data.links : DEFAULT.links;
      return out;
    }
    function domainFrom(url){ try { return new URL(url).hostname.replace(/^www\./,""); } catch { return ""; } }
    function ensureStyleBlock(id, css){
      let el = document.getElementById(id);
      if (!el){ el = document.createElement("style"); el.id=id; document.head.appendChild(el); }
      el.textContent = css;
    }
  })();
</script>
</body>
</html>
